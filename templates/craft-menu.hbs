<form>
    <div id="crafting-form">
        <ul style="display: contents; list-style-type: none;">
            {{#if (equals fileInfo.system worldInfo.system)}}
            {{else}}
            <li class="notification error">This recipes file was made in another game system. Item's probably won't be
                compatible at all!</li>
            {{/if}}
            {{#if (equals fileInfo.world worldInfo.world)}}
            {{else}}
            <li class="notification error">This recipes file was made in another world. There is a possibility of item
                conflicts!</li>
            {{/if}}
        </ul>
        <div class="sc-control-container">
            <div class="sc-search-recipe">
                <p>Search recipes:</p>
                <input type="search" title="Search for a recipe" id="sc-search" class="sc-br-none"
                    data-input="search_recipe" placeholder="Search..." value="{{searchQuery}}" />
            </div>
            <div class="sc-select-recipe-file">
                <p>Current file:</p>
                <select data-select="select_file" title="Select file with the recipes">
                    {{#select (getCurrentFile)}}
                    {{#each fileNames}}
                    <option value="{{this}}">{{this}}</option>
                    {{/each}}
                    {{/select}}
                </select>
            </div>
            <div class="sc-cm-button">
                <button type="button" title="Clear all recipes from selected file" class="sc-br-none sc-br-rad10"
                    data-action="clear-recipe-file">
                    <i class="fas fa-eraser {{#if (notGM)}}sc-disabled{{/if}}"></i>
                </button>
            </div>
            <div class="sc-cm-button">
                <button type="button" title="Create a new recipe file" class="sc-br-none sc-br-rad10"
                    data-action="create-recipe-file">
                    <i class="fas fa-file {{#if (notGM)}}sc-disabled{{/if}}"></i>
                </button>
            </div>
            <div class="sc-cm-button">
                <button type="button" title="Save recipe file" class="sc-br-none sc-br-rad10" data-action="save-recipe-file">
                    <i class="fas fa-floppy-disk {{#if (notGM)}}sc-disabled{{/if}}"></i>
                </button>
            </div>
            <div class="sc-cm-button">
                <button type="button" title="Create a new recipe" class="sc-br-none sc-br-rad10" data-action="add_recipe">
                    <i class="fas fa-plus {{#if (notGM)}}sc-disabled{{/if}}"></i>
                </button>
            </div>
        </div>
        <div class="sc-recipe-container">
            {{#each recipes}}
            {{#if isVisible}}
            <div class="sc-recipe-card sc-br-full sc-br-rad15">
                <div class="sc-edit-container">
                    <div class="sc-edit-name">
                        <p>Recipe name:</p>
                        <input type="text" class="sc-br-none" name="{{id}}.name" value="{{name}}" data-dtype="String">
                    </div>
                    <div class="sc-edit-type">
                        <p>Recipe type:</p>
                        <select name="{{id}}.type">
                            {{#select type}}
                            <option value="text">Text</option>
                            <option value="items">Items</option>
                            {{/select}}
                        </select>
                    </div>
                    <div class="sc-edit-buttons" data-recipe-id="{{id}}">
                        <button type="button" title="Delete recipe" class="sc-br-none sc-br-rad10"
                            data-action="delete_recipe">
                            <i class="fas fa-minus {{#if (notGM)}}sc-disabled{{/if}}"></i>
                        </button>
                        {{#if (equals type "text")}}
                        {{#if editMode}}
                        <button type="button" title="Save recipe" class="sc-br-none sc-br-rad10" data-action="save_recipe">
                            <i class="fas fa-floppy-disk {{#if (notGM)}}sc-disabled{{/if}}"></i>
                        </button>
                        {{else}}
                        <button type="button" title="Edit recipe" class="sc-br-none sc-br-rad10" data-action="edit_recipe">
                            <i class="fas fa-edit {{#if (notGM)}}sc-disabled{{/if}}"></i>
                        </button>
                        {{/if}}
                        {{/if}}
                        <button type="button" title="Craft from recipe" class="sc-br-none sc-br-rad10"
                            data-action="craft_from_recipe">
                            <i class="fas fa-hammer-crash"></i>
                        </button>
                    </div>
                </div>
                <div class="sc-items-container sc-br-full sc-br-rad15" data-recipe-id="{{id}}">
                    <div class="sc-target-item-container sc-br-right sc-br-tl-rad15 sc-br-bl-rad15">
                        {{#if target}}
                        <h2 class="sc-br-bottom" style="margin:0px;">Target item:</h2>
                        <img src="{{target.img}}" class="sc-target-image sc-br-none sc-br-bottom" />
                        <div class="sc-br-bottom">
                            <button type="button" title="Subtract quantity" class="sc-item_button"
                                data-action="substract_quantity_target">
                                <i class="fas fa-angle-left {{#if (notGM)}}sc-disabled{{/if}}"></i>
                            </button>
                            <input type="text" title="Quantity" data-input="change_quantity_target"
                                class="sc-quantity-input sc-br-none sc-br-rad0 sc-br-left sc-br-right"
                                value="{{getCorrectQuantityValue target}}" />
                            <button type="button" title="Add quantity" class="sc-item_button"
                                data-action="add_quantity_target">
                                <i class="fas fa-angle-right {{#if (notGM)}}sc-disabled{{/if}}"></i>
                            </button>
                        </div>
                        <p>{{target.name}}</p>
                        {{else}}
                        <i class="fas fa-circle-down" style="
                        width: 64px;
                        padding: 10px;
                        padding-left: 50%;"></i>
                        {{/if}}
                    </div>
                    {{#if (equals type "text")}}
                    {{#if editMode}}
                    <div class="tmce-editor-container">
                        {{editor
                        description
                        target = (concat id ".description")
                        button = false
                        owner = true
                        class = sc-editor-style
                        editable = true}}
                    </div>
                    {{else}}
                    <div class="sc-description-text-container">
                        <h2 class="sc-br-bottom">Description:</h2>
                        <div class="sc-description-height-limiter">
                            {{{description}}}
                        </div>
                    </div>
                    {{/if}}
                    {{else}}
                    <div class="sc-required-item-container sc-br-none">
                        <h2 class="sc-br-bottom">Required items:</h2>
                        {{#if ingredients}}
                        <div class="sc-required-items">
                            {{#each ingredients}}
                            <div class="sc-required-item sc-br-rad15 sc-br-full" data-item-id="{{@key}}">
                                <img src="{{this.img}}" class="sc-required-image sc-br-none sc-br-right sc-br-tl-rad12_5 sc-br-bl-rad12_5" />
                                <p>{{this.name}}</p>
                                <button type="button" title="Subtract quantity" class="sc-item_button sc-br-rad0 sc-br-left"
                                    data-action="substract_quantity">
                                    <i class="fas fa-angle-left {{#if (notGM)}}sc-disabled{{/if}}"></i>
                                </button>
                                <input type="text" title="Quantity" data-input="change_quantity"
                                    class="sc-quantity-input  sc-br-none sc-br-rad0 sc-br-left sc-br-right"
                                    value="{{getCorrectQuantityValue this}}" />
                                <button type="button" title="Add quantity" class="sc-item_button"
                                    data-action="add_quantity">
                                    <i class="fas fa-angle-right {{#if (notGM)}}sc-disabled{{/if}}"></i>
                                </button>
                                <button type="button" title="Delete item" class="sc-delete-item-button sc-br-left sc-br-rad0 sc-br-tr-rad12_5 sc-br-br-rad12_5"
                                    data-action="delete_item">
                                    <i class="fas fa-minus {{#if (notGM)}}sc-disabled{{/if}}"></i>
                                </button>
                            </div>
                            {{/each}}
                        </div>
                        {{else}}
                        <i class="fas fa-circle-down" style="
                        width: 64px;
                        padding-left: 50%;"></i>
                        {{/if}}
                    </div>
                    {{/if}}
                </div>
            </div>
            {{/if}}
            {{/each}}
        </div>
    </div>
</form>